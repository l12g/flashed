<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Document</title>
  </head>
  <body>
    <div id="fps"></div>
    <canvas
      width="550"
      height="400"
      id="canvas"
      style="background-color: #ccc; margin: 50px"
    ></canvas>
    <canvas
      width="50"
      height="50"
      id="canvas2"
      style="background-color: #ddd; margin: 50px"
    ></canvas>
    <script src="./flashthem.js"></script>
    <script>
      const { Stage, Sprite, Event, Bitmap, TextField, MovieClip, Rect } =
        flashthem;

      let fps = 0;
      let t0 = Date.now();

      const stage = new Stage(document.getElementById("canvas"), 550, 400);
      // stage.addCanvas(document.getElementById("canvas2"));

      const bt1 = new Bitmap("role.jpg");
      const bt2 = new Bitmap("role.jpg");

      bt1.x = bt1.y = 100;
      bt2.x = bt2.y = 200;
      stage.addChild(bt1);
      stage.addChild(bt2);
      document.getElementById("canvas").addEventListener("mousemove", (e) => {
        bt2.x = e.offsetX;
        bt2.y = e.offsetY;
      });
      const rect = new Rect(10, 10, "blue");
      const keys = [0, 0, 0, 0];
      const g = 0.98;
      stage.addChild(rect);
      rect.x = rect.y = 100;

      const db = new Sprite();
      stage.addChild(db);
      bt2.alpha = 0.2;
      bt2.autoSize = false;
      bt2.width = bt2.height = 50;
      bt2.height = 100;
      stage.on("enter-frame", () => {
        bt2.rotation++;
        db.graphics.clear();
        db.graphics.lineStyle(1, "red");
        stage.addChild(db);
        stage.children.forEach((c) => {
          if (c === db) return;
          // const [x, y, w, h] = c.aabb();
          // db.graphics.drawRect(x, y, w, h);
          if (bt1.hitTest(bt2)) {
            console.log("hit");
          }
          bt1.alpha = bt1.hitTest(bt2) ? 0.5 : 1;

          // const [p1, p2, p3, p4] = c.vertex();
          // db.graphics.drawRect(p1[0], p1[1], 10, 10);
          // db.graphics.drawRect(p2[0], p2[1], 10, 10);
          // db.graphics.drawRect(p3[0], p3[1], 10, 10);
          // db.graphics.drawRect(p4[0], p4[1], 10, 10);
        });
      });
    </script>
  </body>
</html>
